Index: cnn.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import torch\nimport torchvision\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport torch.optim as optim\nimport matplotlib.pyplot as plt\nimport random\n\nimport scipy.io\nimport torch\nfrom torch.utils.data import Dataset, DataLoader\nimport torchvision.transforms as transforms\n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\nclass SVHNDataset(Dataset):\n    def __init__(self, mat_file, transform=None):\n        data = scipy.io.loadmat(mat_file)\n        self.X = data['X']            # shape: (32, 32, 3, N)\n        self.y = data['y'].flatten()  # shape: (N,)\n        self.transform = transform\n\n        # SVHN: Label \"10\" bedeutet Ziffer \"0\"\n        self.y[self.y == 10] = 0\n\n    def __len__(self):\n        return self.X.shape[3]\n\n    def __getitem__(self, idx):\n        img = self.X[:,:,:,idx]       # (32,32,3)\n        img = torch.tensor(img).permute(2,0,1).float()/255.0\n        label = int(self.y[idx])\n\n        if self.transform:\n            img = self.transform(img)\n\n        return img, label\n\ntransform = transforms.Normalize((0.5,0.5,0.5), (0.5,0.5,0.5))\n\ntrain_dataset = SVHNDataset('data/train_32x32.mat', transform=transform)\ntest_dataset  = SVHNDataset('data/test_32x32.mat',  transform=transform)\n\ntrain_loader = DataLoader(train_dataset, batch_size=64, shuffle=True)\ntest_loader  = DataLoader(test_dataset,  batch_size=1000, shuffle=False)\n\n\nimport os\n\nfor f in os.listdir():\n    print(f)\nprint(\"train:\", os.path.getsize(\"data/train_32x32.mat\")/1024/1024, \"MB\")\nprint(\"test :\", os.path.getsize(\"data/test_32x32.mat\")/1024/1024, \"MB\")\n\n\n# Let's draw some of the training data\nexamples = enumerate(test_loader)\nbatch_idx, (example_data, example_targets) = next(examples)\n\nfig = plt.figure()\nfor i in range(6):\n  plt.subplot(2,3,i+1)\n  plt.tight_layout()\n  plt.imshow(example_data[i][0], cmap='gray', interpolation='none')\n  plt.title(\"Ground Truth: {}\".format(example_targets[i]))\n  plt.xticks([])\n  plt.yticks([])\nplt.show()\n\nfrom os import X_OK\n# TODO Change this class to implement\n# 1. A valid convolution with kernel size 5, 1 input channel and 10 output channels\n# 2. A max pooling operation over a 2x2 area\n# 3. A Relu\n# 4. A valid convolution with kernel size 5, 10 input channels and 20 output channels\n# 5. A 2D Dropout layer\n# 6. A max pooling operation over a 2x2 area\n# 7. A relu\n# 8. A flattening operation\n# 9. A fully connected layer mapping from (whatever dimensions we are at-- find out using .shape) to 50\n# 10. A ReLU\n# 11. A fully connected layer mapping from 50 to 10 dimensions\n# 12. A softmax function.\n\n# Replace this class which implements a minimal network (which still does okay)\nclass Net(nn.Module):\n    def __init__(self):\n        super(Net, self).__init__()\n        # Valid convolution, 1 channel in, 2 channels out, stride 1, kernel size = 3\n        self.conv1 = nn.Conv2d(3, 10, kernel_size=5)#hier Änderung\n        # Dropout for convolutions\n        self.drop = nn.Dropout2d()\n        # Fully connected layer\n        self.fc1 = nn.Linear(1960, 1000)#hier Änderung\n\n    def forward(self, x):\n        x = self.conv1(x)\n        x = self.drop(x)\n        x = F.max_pool2d(x,2)\n        x = F.relu(x)\n        x = x.flatten(1)\n        x = self.fc1(x)\n        x = F.log_softmax(x)\n        return x\n\n\n\n\n# He initialization of weights\ndef weights_init(layer_in):\n  if isinstance(layer_in, nn.Linear):\n    nn.init.kaiming_uniform_(layer_in.weight)\n    layer_in.bias.data.fill_(0.0)\n\n# Create network\nmodel = Net()\n# Initialize model weights\nmodel.apply(weights_init)\n# Define optimizer\noptimizer = optim.SGD(model.parameters(), lr=0.01, momentum=0.5)\n\n\n# Main training routine\ndef train(epoch):\n  model.train()\n  # Get each\n  for batch_idx, (data, target) in enumerate(train_loader):\n    optimizer.zero_grad()\n    output = model(data)\n    loss = F.nll_loss(output, target)\n    loss.backward()\n    optimizer.step()\n    # Store results\n    if batch_idx % 10 == 0:\n      print('Train Epoch: {} [{}/{}]\\tLoss: {:.6f}'.format(\n        epoch, batch_idx * len(data), len(train_loader.dataset), loss.item()))\n\n# Run on test data\ndef test():\n  model.eval()\n  test_loss = 0\n  correct = 0\n  with torch.no_grad():\n    for data, target in test_loader:\n      output = model(data)\n      test_loss += F.nll_loss(output, target, size_average=False).item()\n      pred = output.data.max(1, keepdim=True)[1]\n      correct += pred.eq(target.data.view_as(pred)).sum()\n  test_loss /= len(test_loader.dataset)\n  print('\\nTest set: Avg. loss: {:.4f}, Accuracy: {}/{} ({:.0f}%)\\n'.format(\n    test_loss, correct, len(test_loader.dataset),\n    100. * correct / len(test_loader.dataset)))\n\n# Get initial performance\ntest()\n# Train for three epochs\nn_epochs = 3\nfor epoch in range(1, n_epochs + 1):\n  train(epoch)\n  test()\n\n# Run network on data we got before and show predictions\noutput = model(example_data)\n\nfig = plt.figure()\nfor i in range(10):\n  plt.subplot(5,5,i+1)\n  plt.tight_layout()\n  plt.imshow(example_data[i][0], cmap='gray', interpolation='none')\n  plt.title(\"Prediction: {}\".format(\n    output.data.max(1, keepdim=True)[1][i].item()))\n  plt.xticks([])\n  plt.yticks([])\nplt.show()\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/cnn.py b/cnn.py
--- a/cnn.py	(revision d9fe387b1ee9b58087a8c1b6c59a94cd47a5faae)
+++ b/cnn.py	(date 1764146429539)
@@ -10,7 +10,6 @@
 import torch
 from torch.utils.data import Dataset, DataLoader
 import torchvision.transforms as transforms
-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
 class SVHNDataset(Dataset):
     def __init__(self, mat_file, transform=None):
         data = scipy.io.loadmat(mat_file)
@@ -24,6 +23,7 @@
     def __len__(self):
         return self.X.shape[3]
 
+
     def __getitem__(self, idx):
         img = self.X[:,:,:,idx]       # (32,32,3)
         img = torch.tensor(img).permute(2,0,1).float()/255.0
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"e453e18b-49d1-41b7-940a-f909ba200b70\" name=\"Changes\" comment=\"\">\n      <change afterPath=\"$PROJECT_DIR$/.idea/inspectionProfiles/profiles_settings.xml\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/.idea/misc.xml\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/.idea/modules.xml\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/.idea/stat_learning.iml\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/.idea/vcs.xml\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/README.md\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/cnn (1) (1).ipynb\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/cnn.ipynb\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/cnn.py\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/requirements.txt\" afterDir=\"false\" />\n      <change afterPath=\"$PROJECT_DIR$/sample.ipynb\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n  </component>\n  <component name=\"ProjectColorInfo\"><![CDATA[{\n  \"associatedIndex\": 1\n}]]></component>\n  <component name=\"ProjectId\" id=\"360U0PpgHX8HcI5PClHKjQW513c\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\"><![CDATA[{\n  \"keyToString\": {\n    \"ModuleVcsDetector.initialDetectionPerformed\": \"true\",\n    \"RunOnceActivity.ShowReadmeOnStart\": \"true\",\n    \"RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252\": \"true\",\n    \"RunOnceActivity.git.unshallow\": \"true\",\n    \"git-widget-placeholder\": \"main\",\n    \"last_opened_file_path\": \"/Users/a49176/Documents/Repos/stat_learning\"\n  }\n}]]></component>\n  <component name=\"SharedIndexes\">\n    <attachedChunks>\n      <set>\n        <option value=\"bundled-python-sdk-ce6832f46686-7b97d883f26b-com.jetbrains.pycharm.pro.sharedIndexes.bundled-PY-252.25557.178\" />\n      </set>\n    </attachedChunks>\n  </component>\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"e453e18b-49d1-41b7-940a-f909ba200b70\" name=\"Changes\" comment=\"\" />\n      <created>1764142758869</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1764142758869</updated>\n    </task>\n    <servers />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision d9fe387b1ee9b58087a8c1b6c59a94cd47a5faae)
+++ b/.idea/workspace.xml	(date 1764146692080)
@@ -1,19 +1,11 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
+  <component name="AutoImportSettings">
+    <option name="autoReloadType" value="SELECTIVE" />
+  </component>
   <component name="ChangeListManager">
     <list default="true" id="e453e18b-49d1-41b7-940a-f909ba200b70" name="Changes" comment="">
-      <change afterPath="$PROJECT_DIR$/.idea/inspectionProfiles/profiles_settings.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/misc.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/modules.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/stat_learning.iml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/vcs.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/README.md" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/cnn (1) (1).ipynb" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/cnn.ipynb" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/cnn.py" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/requirements.txt" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/sample.ipynb" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/cnn.py" beforeDir="false" afterPath="$PROJECT_DIR$/cnn.py" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -23,6 +15,18 @@
   <component name="Git.Settings">
     <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
   </component>
+  <component name="GitHubPullRequestSearchHistory"><![CDATA[{
+  "lastFilter": {
+    "state": "OPEN",
+    "assignee": "Lopo23"
+  }
+}]]></component>
+  <component name="GithubPullRequestsUISettings"><![CDATA[{
+  "selectedUrlAndAccountId": {
+    "url": "https://github.com/Lopo23/CNN.git",
+    "accountId": "e12a568d-ded2-455c-98ee-6693234f454d"
+  }
+}]]></component>
   <component name="ProjectColorInfo"><![CDATA[{
   "associatedIndex": 1
 }]]></component>
@@ -41,6 +45,11 @@
     "last_opened_file_path": "/Users/a49176/Documents/Repos/stat_learning"
   }
 }]]></component>
+  <component name="RecentsManager">
+    <key name="CopyFile.RECENT_KEYS">
+      <recent name="$PROJECT_DIR$" />
+    </key>
+  </component>
   <component name="SharedIndexes">
     <attachedChunks>
       <set>
